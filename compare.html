<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Compare Files - Email Validor</title>
    <link rel="stylesheet" href="style.css" />

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
  </head>
  <body>
    <main>
      <div class="container">
        <!-- Hero Section -->
        <div class="section fade-in-up">
          <div class="hero-tag">
            <i data-lucide="git-compare" width="14" height="14"></i>
            <span>ADVANCED LIST COMPARISON</span>
          </div>

          <h1 class="hero-title">
            List Comparator<br />
            <span style="color: var(--accent-primary)">by Raza Tech Tube</span>
          </h1>

          <p class="hero-subtitle">
            Upload two files to find exclusive contacts. <br />
            The system will remove duplicates and return <strong>ONLY</strong> contacts found in one file but NOT the other.
          </p>

          <!-- Navigation Back -->
          <div class="feature-nav">
            <a href="index.html" class="nav-tab">
              <i data-lucide="arrow-left" width="18" height="18"></i>
              Back to Validator
            </a>
            <div class="nav-tab active">
              <i data-lucide="git-compare" width="18" height="18"></i>
              Compare Mode
            </div>
          </div>

          <!-- Application Container -->
          <div id="app-container" class="w-full">
            
            <!-- Compare View -->
            <div id="compare-view" class="card-panel w-full flex-col gap-md">
               <div class="grid-console" style="grid-template-columns: 1fr 1fr; margin-bottom: 2rem;">
                  <!-- File A Zone -->
                  <div id="drop-zone-a" class="upload-area" style="padding: 2rem;">
                     <input type="file" id="file-input-a" accept=".csv" class="hidden" style="display:none">
                     <div class="upload-icon"><i data-lucide="file" width="40" height="40"></i></div>
                     <h3 style="font-size: 1.2rem; margin-bottom: 0.5rem;">Main File (A)</h3>
                     <p id="file-a-name" style="color: var(--text-muted); font-size: 0.8rem; margin-bottom: 1rem;">No file selected</p>
                     <button id="btn-select-a" class="btn btn-ghost btn-sm">Select File A</button>
                  </div>

                  <!-- File B Zone -->
                  <div id="drop-zone-b" class="upload-area" style="padding: 2rem;">
                     <input type="file" id="file-input-b" accept=".csv" class="hidden" style="display:none">
                     <div class="upload-icon"><i data-lucide="file-minus" width="40" height="40"></i></div>
                     <h3 style="font-size: 1.2rem; margin-bottom: 0.5rem;">Comparison File (B)</h3>
                     <p id="file-b-name" style="color: var(--text-muted); font-size: 0.8rem; margin-bottom: 1rem;">No file selected</p>
                     <button id="btn-select-b" class="btn btn-ghost btn-sm">Select File B</button>
                  </div>
               </div>
               
               <div class="flex-col items-center justify-center">
                  <button id="start-compare-btn" class="btn btn-primary" disabled style="opacity: 0.5; cursor: not-allowed;">
                    <i data-lucide="git-compare" width="20" height="20"></i>
                    Run Exclusive Comparison
                  </button>
                  <p style="margin-top: 1rem; color: var(--text-muted); font-size: 0.8rem;">
                    Returns: (A - B) + ({B - A})<br>
                    Excludes: (A ∩ B)
                  </p>
               </div>
            </div>

            <!-- Processing View (Hidden initially) -->
            <div id="processing-view" class="hidden flex-col gap-lg">
              <!-- Status Header -->
              <div
                class="card-panel"
                style="
                  display: flex;
                  align-items: center;
                  justify-content: space-between;
                "
              >
                <h2
                  style="
                    font-size: 1.5rem;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    gap: 1rem;
                  "
                >
                  <span id="status-icon-container">
                    <!-- Icon injected via JS -->
                  </span>
                  <span id="status-text">Comparing Datasets...</span>
                </h2>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <span id="mode-badge" style="
                      font-size: 0.75rem; 
                      padding: 4px 10px; 
                      border-radius: 99px; 
                      background: rgba(255,255,255,0.1); 
                      color: var(--text-muted);
                      border: 1px solid var(--border-subtle);
                    ">DIFFERENCE MODE</span>
                    <button id="reset-btn" class="btn btn-ghost">
                      <i data-lucide="refresh-cw" width="14" height="14"></i> Reset
                    </button>
                </div>
              </div>

              <!-- Stats Matrix -->
              <div class="grid-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                
                <!-- File A Stats -->
                <div class="stat-card">
                  <h4 style="color: var(--text-muted); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px;">
                    File A Total
                  </h4>
                  <span id="stat-total-a" class="stat-value">0</span>
                </div>

                <!-- File B Stats -->
                <div class="stat-card">
                  <h4 style="color: var(--text-muted); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px;">
                    File B Total
                  </h4>
                  <span id="stat-total-b" class="stat-value">0</span>
                </div>

                <!-- Overlap (Removed) -->
                <div class="stat-card" style="border-color: var(--accent-error);">
                  <i data-lucide="ban" class="text-error" width="24" height="24" style="margin-bottom: 0.5rem"></i>
                  <h4 style="color: var(--accent-error); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px;">
                    Common (Removed)
                  </h4>
                  <span id="stat-overlap" class="stat-value" style="color: var(--accent-error)">0</span>
                </div>

                <!-- Unique Result -->
                <div class="stat-card" style="border-color: var(--accent-success);">
                  <i data-lucide="check-circle" class="text-success" width="24" height="24" style="margin-bottom: 0.5rem"></i>
                  <h4 style="color: var(--accent-success); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px;">
                    Unique Result
                  </h4>
                  <span id="stat-unique-result" class="stat-value" style="color: var(--accent-success)">0</span>
                </div>

              </div>

              <!-- Dashboard -->
              <div class="grid-console">
                <!-- Log Terminal -->
                <div class="log-console">
                  <div class="log-header">
                    <span style="display: flex; align-items: center; gap: 0.5rem">
                      <i data-lucide="file-diff" width="14" height="14"></i>
                      COMPARISON_LOG.log
                    </span>
                    <span class="text-accent" style="font-size: 0.7rem">● ACTIVE</span>
                  </div>
                  <div id="log-content" class="log-content"></div>
                </div>

                <!-- Download Panel -->
                <div id="download-panel-container">
                  <div id="download-waiting" class="card-panel" style="display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0.5; border-style: dashed; height: 100%;">
                    <i data-lucide="activity" style="color: #444; margin-bottom: 1rem" width="40" height="40"></i>
                    <p style="color: var(--text-muted); font-size: 0.9rem">Waiting for comparison...</p>
                  </div>

                  <div id="download-ready" class="card-panel hidden" style="display: flex; flex-direction: column; align-items: center; justify-content: center; border-color: var(--accent-success); height: 100%;">
                    <div style="background: rgba(0, 224, 84, 0.1); padding: 1rem; border-radius: 50%; margin-bottom: 1rem;">
                      <i data-lucide="check-circle" class="text-success" width="40" height="40"></i>
                    </div>
                    <h3 style="font-size: 1.2rem; font-weight: bold; margin-bottom: 0.5rem;">Comparison Complete</h3>
                    <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 1.5rem;">Unique records ready for download.</p>

                    <button id="download-result-btn" class="btn btn-zip" style="width: 100%; justify-content: center;">
                        <i data-lucide="package-check" width="18" height="18"></i>
                        <span>Download Unique (ZIP)</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <script src="compare.js"></script>
  </body>
</html>
